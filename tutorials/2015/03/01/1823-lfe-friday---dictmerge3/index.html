

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>
      LFE Blog
      
         - LFE Friday - dict:merge/3
      
    </title>
    <meta name="description" content="">
    <meta name="author" content="LFEuminati | Alien Alliance">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link href="/assets/themes/lfe/css/reset.css" rel="stylesheet" type="text/css" />
    <link rel="stylesheet" type="text/css" href="/assets/themes/lfe/css-social-buttons/css/zocial.stripped.css">
    <link href="/assets/themes/lfe/css/darkstrap.css" rel="stylesheet" type="text/css" media="all">
    <link href="/assets/themes/lfe/css/style.css?body=1" rel="stylesheet" type="text/css" media="all">
    <link href="/assets/css/twilight.css" rel="stylesheet" type="text/css" media="all">

    <link href="/assets/themes/lfe/css/lfetheme.css" rel="stylesheet" type="text/css" media="all">
    <link href="/assets/themes/lfe/css/pygments.css" media="screen" rel="stylesheet" type="text/css">
    <link href="/assets/css/overrides.css" rel="stylesheet" type="text/css" media="all">
    <link rel="alternate" type="application/atom+xml" href="atom.xml" title="LFE News & Updates Atom Feed">
  </head>
  <body class="overview">
    <div id="header-wrapper">
      <div id="header">
        <div>
          <a class="logo" href="/">LFE Blog</a>
          <ul class="nav">
            <li><a href="/archive.html" class="nav-api">Archives</a></li>
            <li><a href="/categories.html" class="nav-developers">Categories</a></li>
            <li><a href="/tags.html" class="nav-developers">Tags</a></li>
            <li><a href="/authors.html">Authors</a></li>
            <li class="divider">|</li>
            <li><a href="http://plan.lfe.io/">.plan</a></li>
            <li><a href="http://docs.lfe.io/">docs.lfe.io</a></li>
            <li><a href="http://lfe.io/">lfe.io</a></li>
          </ul>
        </div>
      </div><!-- #header -->
    </div><!-- #header-wrapper -->

    

<div class="wrapper">
  <div class="container">
    <div class="content">
      
      <div class="page-header">
        <h1>
          LFE Friday - dict:merge/3
          
        </h1>
      </div>

      <div class="row">
        <div class="span8">
          
<p><a href="/assets/images/posts/LispFlavoredErlang-medium-square.png"><img class="left tiny" src="/assets/images/posts/LispFlavoredErlang-medium-square.png" /></a>This week's LFE Friday was translated with permission from the
<a href="http://www.proctor-it.com/category/erlang/erlang-thursday/">Erlang Thursday</a>
series by <a href="https://twitter.com/stevenproctor">Steven Proctor</a>.
<em>This week's translator</em>: Robert Virding.</p>

<p>Today's LFE Friday is on <a href="http://www.erlang.org/doc/man/dict.html#merge-3">dict:merge/3</a>.</p>

<p><code>dict:merge/3</code> takes 3 arguments, the first argument is a merge function to be called when there is a key collision, and the second and third arguments are dictionaries.</p>

<p>The merge function is a function that takes the key as the first argument, the value from the first dictionary as the second argument, and the value from the second dictionary as the the third argument.</p>

<div class="highlight"><pre><code class="language-cl"><span class="nb">&gt;</span> <span class="p">(</span><span class="nv">dict:to_list</span>
    <span class="p">(</span><span class="nv">dict:merge</span> <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nv">k</span> <span class="nv">value1</span> <span class="nv">value2</span><span class="p">)</span> <span class="p">(</span><span class="nb">list</span> <span class="nv">value1</span> <span class="nv">value2</span><span class="p">))</span>              
                <span class="p">(</span><span class="nv">dict:from_list</span> <span class="o">&#39;</span><span class="p">(</span><span class="o">#(</span><span class="nv">a</span> <span class="mi">1</span><span class="p">)</span> <span class="o">#(</span><span class="nv">b</span> <span class="mi">2</span><span class="p">)</span> <span class="o">#(</span><span class="nv">x</span> <span class="mi">5</span><span class="p">)))</span>
                <span class="p">(</span><span class="nv">dict:from_list</span> <span class="o">&#39;</span><span class="p">(</span><span class="o">#(</span><span class="nv">x</span> <span class="mi">7</span><span class="p">)</span> <span class="o">#(</span><span class="nv">y</span> <span class="mi">8</span><span class="p">)</span> <span class="o">#(</span><span class="nv">z</span> <span class="mi">10</span><span class="p">)))))</span>
<span class="p">(</span><span class="o">#(</span><span class="nv">a</span> <span class="mi">1</span><span class="p">)</span> <span class="o">#(</span><span class="nv">b</span> <span class="mi">2</span><span class="p">)</span> <span class="o">#(</span><span class="nv">x</span> <span class="p">(</span><span class="mi">5</span> <span class="mi">7</span><span class="p">))</span> <span class="o">#(</span><span class="nv">y</span> <span class="mi">8</span><span class="p">)</span> <span class="o">#(</span><span class="nv">z</span> <span class="mi">10</span><span class="p">))</span>
<span class="nb">&gt;</span> <span class="p">(</span><span class="nv">dict:to_list</span>                                                   
    <span class="p">(</span><span class="nv">dict:merge</span> <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nv">k</span> <span class="nv">value1</span> <span class="nv">value2</span><span class="p">)</span> <span class="p">(</span><span class="nb">*</span> <span class="nv">value1</span> <span class="nv">value2</span><span class="p">))</span>   
                <span class="p">(</span><span class="nv">dict:from_list</span> <span class="o">&#39;</span><span class="p">(</span><span class="o">#(</span><span class="nv">a</span> <span class="mi">1</span><span class="p">)</span> <span class="o">#(</span><span class="nv">b</span> <span class="mi">2</span><span class="p">)</span> <span class="o">#(</span><span class="nv">x</span> <span class="mi">5</span><span class="p">)))</span>    
                <span class="p">(</span><span class="nv">dict:from_list</span> <span class="o">&#39;</span><span class="p">(</span><span class="o">#(</span><span class="nv">x</span> <span class="mi">7</span><span class="p">)</span> <span class="o">#(</span><span class="nv">y</span> <span class="mi">8</span><span class="p">)</span> <span class="o">#(</span><span class="nv">z</span> <span class="mi">10</span><span class="p">)))))</span> 
<span class="p">(</span><span class="o">#(</span><span class="nv">a</span> <span class="mi">1</span><span class="p">)</span> <span class="o">#(</span><span class="nv">b</span> <span class="mi">2</span><span class="p">)</span> <span class="o">#(</span><span class="nv">x</span> <span class="mi">35</span><span class="p">)</span> <span class="o">#(</span><span class="nv">y</span> <span class="mi">8</span><span class="p">)</span> <span class="o">#(</span><span class="nv">z</span> <span class="mi">10</span><span class="p">))</span></code></pre></div>

<p>The merge function passed to <code>dict:merge/3</code> only gets called in the case of a collision, as shown below.  Note that there is a call to <code>exit/1</code> in the body of the function which would cause the process to terminate if the function was ever invoked.</p>

<div class="highlight"><pre><code class="language-cl"><span class="nb">&gt;</span> <span class="p">(</span><span class="nv">dict:to_list</span>                                                
    <span class="p">(</span><span class="nv">dict:merge</span> <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nv">k</span> <span class="nv">value1</span> <span class="nv">value2</span><span class="p">)</span> <span class="p">(</span><span class="nv">exit</span> <span class="ss">&#39;merge-happened</span><span class="p">))</span>
                <span class="p">(</span><span class="nv">dict:from_list</span> <span class="o">&#39;</span><span class="p">(</span><span class="o">#(</span><span class="nv">a</span> <span class="mi">1</span><span class="p">)</span> <span class="o">#(</span><span class="nv">b</span> <span class="mi">2</span><span class="p">)))</span>                
                <span class="p">(</span><span class="nv">dict:from_list</span> <span class="o">&#39;</span><span class="p">(</span><span class="o">#(</span><span class="nv">x</span> <span class="mi">7</span><span class="p">)</span> <span class="o">#(</span><span class="nv">y</span> <span class="mi">8</span><span class="p">)</span> <span class="o">#(</span><span class="nv">z</span> <span class="mi">10</span><span class="p">)))))</span>      
<span class="p">(</span><span class="o">#(</span><span class="nv">a</span> <span class="mi">1</span><span class="p">)</span> <span class="o">#(</span><span class="nv">b</span> <span class="mi">2</span><span class="p">)</span> <span class="o">#(</span><span class="nv">x</span> <span class="mi">7</span><span class="p">)</span> <span class="o">#(</span><span class="nv">y</span> <span class="mi">8</span><span class="p">)</span> <span class="o">#(</span><span class="nv">z</span> <span class="mi">10</span><span class="p">))</span></code></pre></div>

<p>If you wish to treat the merge as an overlay of the second dictionary over the first, the merge function just needs to return the value from the second dictionary in the case of a key conflict.</p>

<div class="highlight"><pre><code class="language-cl"><span class="nb">&gt;</span> <span class="p">(</span><span class="nv">dict:to_list</span>                                                     
    <span class="p">(</span><span class="nv">dict:merge</span> <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nv">k</span> <span class="nv">value1</span> <span class="nv">value2</span><span class="p">)</span> <span class="nv">value2</span><span class="p">)</span>                
                <span class="p">(</span><span class="nv">dict:from_list</span> <span class="o">&#39;</span><span class="p">(</span><span class="o">#(</span><span class="nv">a</span> <span class="mi">1</span><span class="p">)</span> <span class="o">#(</span><span class="nv">b</span> <span class="mi">2</span><span class="p">)</span> <span class="o">#(</span><span class="nv">x</span> <span class="mi">5</span><span class="p">)))</span>         
                <span class="p">(</span><span class="nv">dict:from_list</span> <span class="o">&#39;</span><span class="p">(</span><span class="o">#(</span><span class="nv">x</span> <span class="mi">7</span><span class="p">)</span> <span class="o">#(</span><span class="nv">y</span> <span class="mi">8</span><span class="p">)</span> <span class="o">#(</span><span class="nv">z</span> <span class="mi">10</span><span class="p">)))))</span>      
<span class="p">(</span><span class="o">#(</span><span class="nv">a</span> <span class="mi">1</span><span class="p">)</span> <span class="o">#(</span><span class="nv">b</span> <span class="mi">2</span><span class="p">)</span> <span class="o">#(</span><span class="nv">x</span> <span class="mi">7</span><span class="p">)</span> <span class="o">#(</span><span class="nv">y</span> <span class="mi">8</span><span class="p">)</span> <span class="o">#(</span><span class="nv">z</span> <span class="mi">10</span><span class="p">))</span></code></pre></div>

<p>If you want to keep all of the keys and values in the first dictionary, and just add the keys and values that are in the second dictionary, but not in the first dictionary, the merge function should just return the value associated with the first dictionary.</p>

<div class="highlight"><pre><code class="language-cl"><span class="nb">&gt;</span> <span class="p">(</span><span class="nv">dict:to_list</span>                                               
     <span class="p">(</span><span class="nv">dict:merge</span> <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nv">k</span> <span class="nv">value1</span> <span class="nv">value2</span><span class="p">)</span> <span class="nv">value1</span><span class="p">)</span>          
                 <span class="p">(</span><span class="nv">dict:from_list</span> <span class="o">&#39;</span><span class="p">(</span><span class="o">#(</span><span class="nv">a</span> <span class="mi">1</span><span class="p">)</span> <span class="o">#(</span><span class="nv">b</span> <span class="mi">2</span><span class="p">)</span> <span class="o">#(</span><span class="nv">x</span> <span class="mi">5</span><span class="p">)))</span>   
                 <span class="p">(</span><span class="nv">dict:from_list</span> <span class="o">&#39;</span><span class="p">(</span><span class="o">#(</span><span class="nv">x</span> <span class="mi">7</span><span class="p">)</span> <span class="o">#(</span><span class="nv">y</span> <span class="mi">8</span><span class="p">)</span> <span class="o">#(</span><span class="nv">z</span> <span class="mi">10</span><span class="p">)))))</span>
<span class="p">(</span><span class="o">#(</span><span class="nv">a</span> <span class="mi">1</span><span class="p">)</span> <span class="o">#(</span><span class="nv">b</span> <span class="mi">2</span><span class="p">)</span> <span class="o">#(</span><span class="nv">x</span> <span class="mi">5</span><span class="p">)</span> <span class="o">#(</span><span class="nv">y</span> <span class="mi">8</span><span class="p">)</span> <span class="o">#(</span><span class="nv">z</span> <span class="mi">10</span><span class="p">))</span></code></pre></div>

<p>Just a peek into the new Maps that came in to Erlang in the 17.0 release.</p>

<p>-Proctor, Robert</p>

          <hr>
          <div class="pagination btn-group">
            
            <a class="btn prev" href="/tutorials/2015/02/20/1609-lfe-friday---stringjoin2" title="LFE Friday - string:join/2">&larr; Previous</a>
            
            <a class="btn" href="/archive.html">Archive</a>
            
            <a class="btn next" href="/tutorials/2015/03/06/0152-lfe-friday---calendarlocal_time_to_universal_time_dst1" title="LFE Friday - calendar:local_time_to_universal_time_dst/1">Next &rarr;</a>
            
          </div>
          <hr>
          
        </div>

        <div class="span4">
          <section>
            <h4>Author</h4>
            <div class="author"><span><a href="/authors.html#Robert Virding">Robert Virding</a></span></div>
          </section>
          <section>
            <h4>Published</h4>
            <div class="date"><span>01 March 2015</span></div>
          </section>
          
          <section>
            <h4>Category</h4>
            <span class="category">
              tutorials
            </span>
          </section>
          
          
          <section>
            <h4>Tags</h4>
            <ul class="tag_box">
              
              


  
     
    	<li><a href="/tags.html#lfe friday-ref">lfe friday <span>58</span></a></li>
     
    	<li><a href="/tags.html#lfe-ref">lfe <span>63</span></a></li>
     
    	<li><a href="/tags.html#erlang-ref">erlang <span>71</span></a></li>
    
  



            </ul>
          </section>
          
        </div>
      </div>


    </div>
  </div> <!-- /container -->
</div>




    <div id="footer" >
    <div class="lower_footer">
      <ul class="footer-cell">
        <li><a href="/archive.html">Archives</a></li>
        <li><a href="/categories.html">Categories</a></li>
        <li><a href="/tags.html">Tags</a></li>
        <li><a href="/authors.html">Authors</a></li>
        <li><a href="/pages.html">Pages</a></li>
      </ul>

      <span class="footer-cell">
        <a href="/"><img src="/assets/themes/lfe/images/logo-white.png"/></a>
      </span>

      <ul class="footer-cell">
        <li><a href="http://github.com/lfex">lfex</a></li>
        <li><a href="https://groups.google.com/forum/#!forum/lisp-flavoured-erlang">List</a></li>
        <li><a href="http://webchat.freenode.net/?channels=erlang-lisp">IRC</a></li>
        <li><a href="http://feeds.feedburner.com/lfe/news-and-updates">RSS</a></li>
        <li><a href="http://twitter.com/ErlangLisp">Twitter</a></li>
        <li><a href="http://github.com/rvirding/lfe">Github</a></li>
      </ul>
    </div>

    <div class="wrapper">
      <p>Original Design &copy; <span class="js-year"></span> GitHub, Inc.</p>
      <p>LFE Design and Content &copy; <span class="js-year"></span> LFEuminati | Alien Alliance</p>
    </div>

  </div><!-- /#footer -->

    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
    <script>window.jQuery || document.write('<script src="/assets/themes/lfe/js/jquery.min.js"><\/script>')</script>
    <script src="/assets/themes/lfe/bootstrap/js/bootstrap.min.js"></script>

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-38274766-2', 'auto');
      ga('send', 'pageview');

    </script>
  </body>
</html>

