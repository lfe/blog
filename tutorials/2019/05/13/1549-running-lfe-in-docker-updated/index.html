

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>
      LFE Blog
      
         - Running LFE in Docker, Updated
      
    </title>
    <meta name="description" content="Significant changes have been made to the LFE Docker support of late, least of which is using the official Erlang Docker images as the base. This post is an update to the 2014 post on LFE with Docker that takese these recent changes into account.">
    <meta name="author" content="LFEuminati | Alien Alliance">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link href="/assets/themes/lfe/css/reset.css" rel="stylesheet" type="text/css" />
    <link rel="stylesheet" type="text/css" href="/assets/themes/lfe/css-social-buttons/css/zocial.stripped.css">
    <link href="/assets/themes/lfe/css/darkstrap.css" rel="stylesheet" type="text/css" media="all">
    <link href="/assets/themes/lfe/css/style.css?body=1" rel="stylesheet" type="text/css" media="all">
    <link href="/assets/css/twilight.css" rel="stylesheet" type="text/css" media="all">

    <link href="/assets/themes/lfe/css/lfetheme.css" rel="stylesheet" type="text/css" media="all">
    <link href="/assets/themes/lfe/css/pygments.css" media="screen" rel="stylesheet" type="text/css">
    <link href="/assets/css/overrides.css" rel="stylesheet" type="text/css" media="all">
    <link rel="alternate" type="application/atom+xml" href="atom.xml" title="LFE News & Updates Atom Feed">
  </head>
  <body class="overview">
    <div id="header-wrapper">
      <div id="header">
        <div>
          <a class="logo" href="/">LFE Blog</a>
          <ul class="nav">
            <li><a href="/archive.html" class="nav-api">Archives</a></li>
            <li><a href="/categories.html" class="nav-developers">Categories</a></li>
            <li><a href="/tags.html" class="nav-developers">Tags</a></li>
            <li><a href="/authors.html">Authors</a></li>
            <li class="divider">|</li>
            <li><a href="http://plan.lfe.io/">.plan</a></li>
            <li><a href="http://docs.lfe.io/">docs.lfe.io</a></li>
            <li><a href="http://lfe.io/">lfe.io</a></li>
          </ul>
        </div>
      </div><!-- #header -->
    </div><!-- #header-wrapper -->

    

<div class="wrapper">
  <div class="container">
    <div class="content">
      
      <div class="page-header">
        <h1>
          Running LFE in Docker, Updated
          
        </h1>
      </div>

      <div class="row">
        <div class="span8">
          
<p><a href="/assets/images/posts/DockerLogo.png"><img class="right thumb" src="/assets/images/posts/DockerLogo.png" /></a>So much
changed since the <a href="">original version of this tutorial</a> was created, back in 2014 â€“ not the least of which is <a href="https://www.docker.com/">Docker</a>'s 
continued rise in the industry. There have been many new releases of Erlang and there is an actively
supported Dockerhub repo of Erlang Docker images. Most significantly for LFE users, though, are the 
following changes:</p>

<ul>
  <li>The <a href="https://hub.docker.com/r/lfex/lfe/tags">LFE images</a> now use the 
<a href="https://hub.docker.com/_/erlang?tab=tags">official Erlang Docker images</a> as their base</li>
  <li>As such, the only two distributions supported are Debign and Alpine (OpenSUSE, Fedora, 
Tinycore, etc., are no longer supported)</li>
  <li>The LFE images now use <code>ENTRYPOINT</code>, allowing them to be easily used interchangably with 
on-system <code>lfe</code> binary</li>
</ul>

<p>To that last point, this means that when you see an example calling the <code>lfe</code> binary, you'll be able to 
use that with the LFE Docker images by interchanging that with a call to <code>docker run</code> instead (details on
that below).</p>

<p>This post not only is an update to the 2014 LFE/Docker blog post, it's an update to the 
<a href="/tutorials/2015/11/28/2110-lfe-yaws-docker-update/">2015 LFE/YAWS/Docker post</a>.
Content is taken from those as well as the current 
<a href="https://github.com/lfex/dockerfiles">lfex/dockerfiles README</a>.</p>

<h2 id="setup">Setup</h2>

<p>This tutorial assumes that you have <a href="https://www.docker.com/">Docker</a> installed on a host machine.</p>

<p>You don't need LFE or Erlang installed on your system to do the rest of this tutorial.</p>

<h2 id="images">Images</h2>

<p>Since they are based upon the Erlang Docker images, the supported LFE image distros are as 
follows:</p>

<ul>
  <li>standard (Debian, <a href="https://hub.docker.com/_/buildpack-deps/">buildpack-deps</a>
based images)</li>
  <li>slim (Debian based images with only what Erlang requires)</li>
  <li>alpine</li>
</ul>

<p>These include the following LFE versions:</p>

<ul>
  <li>1.3-dev (with some additional features from still-open PRs)</li>
</ul>

<p>Dependeing upon image type, some or all of the following Erlang versions are
available:</p>

<ul>
  <li>17.5 (only with standard image type)</li>
  <li>18.3 (standard and slim)</li>
  <li>19.3 (standard and slim)</li>
  <li>20.3 (all)</li>
  <li>21.3 (all)</li>
</ul>

<p>The LFE images are published with tags in the following format:</p>

<div class="highlight"><pre><code>[org]/[project]:[lfe-version]-[erlang-version]-[image-type]
</code></pre></div>

<p>For example, LFE v1.3 running on Erlang 20.3 in the Debian-based slim container would be:</p>

<div class="highlight"><pre><code>lfex/lfe:1.3-20.3-slim
</code></pre></div>

<p>Note that the Alpine image is considered the canonical one, thus the <code>latest</code>
tag is against an Alpine image with the most recent release of LFE and Erlang.
If this is what you want, than simply using either of the following will pull
this down:</p>

<div class="highlight"><pre><code>$ docker run -it lfex/lfe:latest
</code></pre></div>

<p>or</p>

<div class="highlight"><pre><code>$ docker run -it lfex/lfe
</code></pre></div>

<p>Which, as noted, is currently the same as <code>lfex/lfe:1.3-21.3-alpine</code>.</p>

<p>To help make your image selection process better informed, the following table is
given in the README, comparing the LFE and Erlang image types and their sizes:</p>

<table>
  <thead>
    <tr>
      <th>REPOSITORY</th>
      <th>TAG</th>
      <th>SIZE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>lfex/lfe</td>
      <td>latest</td>
      <td>80.1MB</td>
    </tr>
    <tr>
      <td>lfex/lfe</td>
      <td>1.3-21.3-alpine</td>
      <td>80.1MB</td>
    </tr>
    <tr>
      <td>lfex/lfe</td>
      <td>1.3-20.3-alpine</td>
      <td>84MB</td>
    </tr>
    <tr>
      <td>lfex/lfe</td>
      <td>1.3-21.3-slim</td>
      <td>258MB</td>
    </tr>
    <tr>
      <td>lfex/lfe</td>
      <td>1.3-20.3-slim</td>
      <td>266MB</td>
    </tr>
    <tr>
      <td>lfex/lfe</td>
      <td>1.3-19.3-slim</td>
      <td>523MB</td>
    </tr>
    <tr>
      <td>lfex/lfe</td>
      <td>1.3-18.3-slim</td>
      <td>277MB</td>
    </tr>
    <tr>
      <td>lfex/lfe</td>
      <td>1.3-21.3-standard</td>
      <td>1.07GB</td>
    </tr>
    <tr>
      <td>lfex/lfe</td>
      <td>1.3-20.3-standard</td>
      <td>1.08GB</td>
    </tr>
    <tr>
      <td>lfex/lfe</td>
      <td>1.3-19.3-standard</td>
      <td>1.1GB</td>
    </tr>
    <tr>
      <td>lfex/lfe</td>
      <td>1.3-18.3-standard</td>
      <td>1.1GB</td>
    </tr>
    <tr>
      <td>lfex/lfe</td>
      <td>1.3-17.5-standard</td>
      <td>753MB</td>
    </tr>
  </tbody>
</table>

<table>
  <thead>
    <tr>
      <th>REPOSITORY</th>
      <th>TAG</th>
      <th>SIZE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>erlang</td>
      <td>21.3-alpine</td>
      <td>73.3MB</td>
    </tr>
    <tr>
      <td>erlang</td>
      <td>20.3-alpine</td>
      <td>77.2MB</td>
    </tr>
    <tr>
      <td>erlang</td>
      <td>21.3-slim</td>
      <td>251MB</td>
    </tr>
    <tr>
      <td>erlang</td>
      <td>20.3-slim</td>
      <td>258MB</td>
    </tr>
    <tr>
      <td>erlang</td>
      <td>19.3-slim</td>
      <td>515MB</td>
    </tr>
    <tr>
      <td>erlang</td>
      <td>18.3-slim</td>
      <td>270MB</td>
    </tr>
    <tr>
      <td>erlang</td>
      <td>21.3</td>
      <td>1.07GB</td>
    </tr>
    <tr>
      <td>erlang</td>
      <td>20.3</td>
      <td>1.07GB</td>
    </tr>
    <tr>
      <td>erlang</td>
      <td>19.3</td>
      <td>1.09GB</td>
    </tr>
    <tr>
      <td>erlang</td>
      <td>18.3</td>
      <td>1.09GB</td>
    </tr>
    <tr>
      <td>erlang</td>
      <td>17.5</td>
      <td>746MB</td>
    </tr>
  </tbody>
</table>

<h2 id="usage">Usage</h2>

<p>We're going to look at a handful of different usages of the LFE Docker images in the 
following sections:</p>

<ul>
  <li>As a means of running the LFE REPL</li>
  <li>Running examples with the image's <code>lfe</code> executable as the entry point</li>
  <li>Running script examples as entry points</li>
  <li>A custom app, ready to deploy to a Docker container hosting service</li>
</ul>

<h3 id="instant-repl">Instant REPL</h3>

<p>Running an LFE REPL in any of the provided images is as simple as the following:</p>

<div class="highlight"><pre><code>$ docker run -it lfex/lfe
</code></pre></div>

<div class="highlight"><pre><code>Erlang/OTP 21 [erts-10.3.5] [source] [64-bit] [smp:6:6] [ds:6:6:10] [async-threads:1] [hipe]

   ..-~.~_~---..
  (      \\     )    |   A Lisp-2+ on the Erlang VM
  |`-.._/_\\_.-':    |   Type (help) for usage info.
  |         g |_ \   |
  |        n    | |  |   Docs: http://docs.lfe.io/
  |       a    / /   |   Source: http://github.com/rvirding/lfe
   \     l    |_/    |
    \   r     /      |   LFE v1.3-dev (abort with ^G)
     `-E___.-'

lfe&gt;
</code></pre></div>

<h3 id="running-examples">Running Examples</h3>

<h4 id="modules-via-cli">Modules via CLI</h4>

<p>Some of the LFE example modules have been compiled in these Docker images for
your testing convenience. How they are run depends upon each example. For
instance, here's how to run the LFE port of the classic Erlang "ring" example:</p>

<div class="highlight"><pre><code>$ docker run lfex/lfe -pa examples/ebin -noshell -run ring main 503 50000000
</code></pre></div>

<p>Note that, because these Docker images use <code>ENTRYPOINT</code>, they can be run just
like you run the installed <code>lfe</code> binary on a system, complete with command line
flags. The only difference is that instead of typing <code>lfe</code> in the terminal,
we type <code>docker run lfex/lfe:1.3-20.3-alpine</code>.</p>

<p>This will run for a while, then you'll get the expected output:</p>

<div class="highlight"><pre><code>Result: 292
</code></pre></div>

<p>Another example, based on
http://joearms.github.io/2013/11/21/My-favorite-erlang-program.html, will take
<em>quite</em> a long while to finish:</p>

<div class="highlight"><pre><code>$ docker run lfex/lfe:1.3-18.3-slim -pa examples/ebin -noshell -run joes-fav run-it
</code></pre></div>

<div class="highlight"><pre><code>30414093201713378043612608166064768844377641568960512000000000000
</code></pre></div>

<h4 id="interactive-modules-via-main">Interactive Modules via <code>main</code></h4>

<p>For interactive modules where you don't need the LFE prompt:</p>

<div class="highlight"><pre><code>$ docker run -i lfex/lfe \
  -pa examples/ebin -noshell -run guessing-game main
</code></pre></div>

<div class="highlight"><pre><code>Guess the number I have chosen, between 1 and 10.
Guess number: 1
Your guess is too low.
Guess number: 10
Your guess is too high.
Guess number: 5
Well-guessed!!
</code></pre></div>

<h4 id="precompiled-modules-via-lfe-repl">Precompiled Modules via LFE REPL</h4>

<p>Another pre-compiled module in the Docker images is the one demonstrating
Church numerals in LFE. To use it, you just need to include the <code>examples/ebin</code>
in the Elrang modules path:</p>

<div class="highlight"><pre><code>$ docker run -it lfex/lfe:latest -pa examples/ebin
</code></pre></div>

<div class="highlight"><pre><code class="language-lisp"><span class="nv">lfe&gt;</span> <span class="p">(</span><span class="nv">church:one</span><span class="p">)</span>
<span class="err">#</span><span class="nv">Fun&lt;church.1.125931718&gt;</span>
<span class="nv">lfe&gt;</span> <span class="p">(</span><span class="nv">church:get-church</span> <span class="mi">10</span><span class="p">)</span>
<span class="err">#</span><span class="nv">Fun&lt;church.7.125931718&gt;</span>
<span class="nv">lfe&gt;</span> <span class="p">(</span><span class="nv">church:church-&gt;int1</span> <span class="p">(</span><span class="nv">church:get-church</span> <span class="mi">20</span><span class="p">))</span>
<span class="mi">20</span></code></pre></div>

<p>Another pre-compiled example, utilizing Erlang inboxes and message-passing:</p>

<div class="highlight"><pre><code class="language-lisp"><span class="nv">lfe&gt;</span> <span class="p">(</span><span class="nv">messenger-back:send-message</span> <span class="p">(</span><span class="nv">self</span><span class="p">)</span> <span class="s">&quot;Well, I was able to extend the original entry a bit, yes.&quot;</span><span class="p">)</span>
<span class="o">#(</span><span class="err">#</span><span class="nv">Pid&lt;0.80.0&gt;</span> <span class="s">&quot;Well, I was able to extend the original entry a bit, yes.&quot;</span><span class="p">)</span>
<span class="nv">Received</span> <span class="nv">message:</span> <span class="ss">&#39;Well,</span> <span class="nv">I</span> <span class="nv">was</span> <span class="nv">able</span> <span class="nv">to</span> <span class="nv">extend</span> <span class="k">the</span> <span class="nv">original</span> <span class="nv">entry</span> <span class="nv">a</span> <span class="nv">bit,</span> <span class="nv">yes.</span><span class="o">&#39;</span>
<span class="nv">Sending</span> <span class="nv">message</span> <span class="nv">to</span> <span class="nv">process</span> <span class="nv">&lt;0.80.0&gt;</span> <span class="o">...</span>
<span class="nv">lfe&gt;</span> <span class="p">(</span><span class="nv">messenger-back:send-message</span> <span class="p">(</span><span class="nv">self</span><span class="p">)</span> <span class="s">&quot;And what does it say now?&quot;</span><span class="p">)</span>
<span class="o">#(</span><span class="err">#</span><span class="nv">Pid&lt;0.80.0&gt;</span> <span class="s">&quot;And what does it say now?&quot;</span><span class="p">)</span>
<span class="nv">Received</span> <span class="nv">message:</span> <span class="ss">&#39;And</span> <span class="nv">what</span> <span class="nv">does</span> <span class="nv">it</span> <span class="nv">say</span> <span class="nv">now?</span><span class="o">&#39;</span>
<span class="nv">Sending</span> <span class="nv">message</span> <span class="nv">to</span> <span class="nv">process</span> <span class="nv">&lt;0.80.0&gt;</span> <span class="o">...</span>
<span class="nv">lfe&gt;</span> <span class="p">(</span><span class="nv">messenger-back:send-message</span> <span class="p">(</span><span class="nv">self</span><span class="p">)</span> <span class="s">&quot;Mostly harmless.&quot;</span><span class="p">)</span>
<span class="o">#(</span><span class="err">#</span><span class="nv">Pid&lt;0.80.0&gt;</span> <span class="s">&quot;Mostly harmless.&quot;</span><span class="p">)</span>
<span class="nv">Received</span> <span class="nv">message:</span> <span class="ss">&#39;Mostly</span> <span class="nv">harmless.</span><span class="o">&#39;</span>
<span class="nv">Sending</span> <span class="nv">message</span> <span class="nv">to</span> <span class="nv">process</span> <span class="nv">&lt;0.80.0&gt;</span> <span class="o">...</span></code></pre></div>

<p>Then, we can flush the REPL process' inbox to see all the messages it has
received:</p>

<div class="highlight"><pre><code class="language-lisp"><span class="p">(</span><span class="nv">c:flush</span><span class="p">)</span>
<span class="nv">Shell</span> <span class="nv">got</span> <span class="nv">{</span><span class="s">&quot;Well, I was able to extend the original entry a bit, yes.&quot;</span><span class="nv">}</span>
<span class="nv">Shell</span> <span class="nv">got</span> <span class="nv">{</span><span class="s">&quot;And what does it say now?&quot;</span><span class="nv">}</span>
<span class="nv">Shell</span> <span class="nv">got</span> <span class="nv">{</span><span class="s">&quot;Mostly harmless.&quot;</span><span class="nv">}</span>
<span class="nv">ok</span></code></pre></div>

<h4 id="slurping-modules-via-lfe-repl">Slurping Modules via LFE REPL</h4>

<p>If we wanted to run one of the LFE examples that is not pre-compiled (or, as
is the case for the following example, run code that is not meant to be
compiled, but instead simply run in a REPL session), we can just use <code>slurp</code>.
Here's the General Problem Solver LFE example using this approach:</p>

<div class="highlight"><pre><code>$ docker run -it lfex/lfe
</code></pre></div>

<div class="highlight"><pre><code class="language-lisp"><span class="nv">lfe&gt;</span> <span class="p">(</span><span class="nv">slurp</span> <span class="s">&quot;examples/gps1.lfe&quot;</span><span class="p">)</span></code></pre></div>

<div class="highlight"><pre><code class="language-lisp"><span class="o">#(</span><span class="nv">ok</span> <span class="nv">gps1</span><span class="p">)</span></code></pre></div>

<div class="highlight"><pre><code class="language-lisp"><span class="nv">lfe&gt;</span> <span class="p">(</span><span class="nv">gps</span> <span class="o">&#39;</span><span class="p">(</span><span class="nv">son-at-home</span> <span class="nv">car-needs-battery</span> <span class="nv">have-money</span> <span class="nv">have-phone-book</span><span class="p">)</span>
<span class="nv">lfe&gt;</span>      <span class="o">&#39;</span><span class="p">(</span><span class="nv">son-at-school</span><span class="p">)</span>
<span class="nv">lfe&gt;</span>      <span class="p">(</span><span class="nv">school-ops</span><span class="p">))</span></code></pre></div>

<div class="highlight"><pre><code>executing 'look-up-number'
executing 'telephone-shop'
executing 'tell-shop-problem'
executing 'give-shop-money'
executing 'shop-installs-battery'
executing 'drive-son-to-school'
solved
</code></pre></div>

<h4 id="scripts">Scripts</h4>

<p>You can also run the LFE example scripts by changing the entry point:</p>

<div class="highlight"><pre><code>$ docker run --entrypoint=examples/sample-lfescript lfex/lfe:1.3-20.3-standard
</code></pre></div>

<p>This will give us an error, since we didn't pass it the correct argument type:</p>

<div class="highlight"><pre><code>usage: examples/sample-lfescript &lt;integer&gt;
</code></pre></div>

<p>Now that we know what to do, thanks to the usage message, let's try again:</p>

<div class="highlight"><pre><code>$ docker run --entrypoint=examples/sample-lfescript lfex/lfe:1.3-20.3-slim 10
</code></pre></div>

<div class="highlight"><pre><code>factorial 10 = 3628800
</code></pre></div>

<p>Or another script example:</p>

<div class="highlight"><pre><code>$ docker run --entrypoint=examples/sample-lfe-shellscript lfex/lfe 5
</code></pre></div>

<div class="highlight"><pre><code>factorial 5 = 120
</code></pre></div>

<h2 id="a-simple-lfeyaws-web-app-image">A Simple LFE/YAWS Web App Image</h2>

<p>Let's go nuts!</p>

<div class="highlight"><pre><code class="language-bash"><span class="nv">$ </span>mkdir /tmp/sample-app
<span class="nv">$ </span><span class="nb">cd</span> /tmp/sample-app
<span class="nv">$ </span>vi Dockerfile</code></pre></div>

<div class="highlight"><pre><code class="language-dockerfile"><span class="k">FROM</span> lfex/lfe

<span class="k">ENV</span> APP_DIR /opt/sample-app
<span class="k">ENV</span> APP_REPO https://github.com/oubiwann/docker-lfe-yaws-sample-app.git
<span class="k">ENV</span> DEPS_DIR <span class="nv">$APP_DIR</span>/deps
<span class="k">ENV</span> YAWS_DIR <span class="nv">$DEPS_DIR</span>/yaws
<span class="k">ENV</span> YAWS_APP_ID sampleapp
<span class="k">ENV</span> LFE_DEPS <span class="nv">$DEPS_DIR</span>/lutil:<span class="nv">$DEPS_DIR</span>/exemplar:<span class="nv">$DEPS_DIR</span>/lfest
<span class="k">ENV</span> DEPS <span class="nv">$YAWS_DIR</span>:<span class="nv">$LFE_DEPS</span>:<span class="nv">$DEPS_DIR</span>/ibrowse
<span class="k">ENV</span> ERL_LIBS <span class="nv">$ERL_LIBS</span>:/opt/erlang/lfe:<span class="nv">$DEPS</span>

<span class="k">RUN</span> apt-get update <span class="o">&amp;&amp;</span> apt-get install -y <span class="err">\</span>
        libpam0g-dev

<span class="k">RUN</span> git clone <span class="nv">$APP_REPO</span> <span class="nv">$APP_DIR</span> <span class="o">&amp;&amp;</span> <span class="err">\</span>
        <span class="nb">cd</span> <span class="nv">$APP_DIR</span> <span class="o">&amp;&amp;</span> <span class="err">\</span>
        rebar compile

<span class="k">EXPOSE</span> <span class="m">5099</span>

<span class="k">CMD</span> sh -c <span class="s2">&quot;/opt/sample-app/bin/daemon;while true; do sleep 10; done&quot;</span></code></pre></div>

<div class="highlight"><pre><code class="language-vim"><span class="p">:</span><span class="k">x</span></code></pre></div>

<div class="highlight"><pre><code class="language-bash"><span class="nv">$ </span>docker build .
...
Successfully built 1904cb1d856b</code></pre></div>

<p>Now we can tag it:</p>

<div class="highlight"><pre><code class="language-bash"><span class="nv">$ </span>docker tag 1904cb1d856b sample-app</code></pre></div>

<p>And then run it!</p>

<div class="highlight"><pre><code class="language-bash"><span class="nv">$ </span>docker run -d -p 5099:5099 sample-app
1b21f79c42ec84cec841b25ff17e921b4d4ce8ee247c5293d5c0d73766a4c713</code></pre></div>

<p>Let's make sure that it's running and that our port is exposed:</p>

<div class="highlight"><pre><code class="language-bash"><span class="nv">$ </span>docker ps
CONTAINER ID   IMAGE               COMMAND                STATUS         PORTS
1b21f79c42ec   sample-app:latest   <span class="err">&quot;</span><span class="se">\&quot;</span>/bin/sh -c <span class="err">&#39;</span>sh -c   Up <span class="m">6</span> seconds   0.0.0.0:5099-&gt;5099/tcp</code></pre></div>

<p>And then open up <a href="http://172.16.4.64:5099">http://172.16.4.64:5099</a>
(or whatever host you setup for SSH port forwarding) in a web browser. You
should be greeted with something that looks like this:</p>

<p><img src="/assets/images/posts/docker-lfe-sample-app-main-page.png" /></p>

<p>And that's all there is to it!</p>

<h2 id="an-lfe-web-app-aside">An LFE Web App Aside</h2>

<p>If you'd like to look at the source code for this sample app, it has been
made available here:</p>

<ul>
  <li><a href="https://github.com/oubiwann/docker-lfe-yaws-sample-app">https://github.com/oubiwann/docker-lfe-yaws-sample-app</a></li>
</ul>

<p>It takes advantage of two interesting LFE libraries:</p>

<ul>
  <li><a href="https://github.com/lfex/lfest">lfest</a> - a
Clojure/<a href="https://github.com/weavejester/compojure">Compojure</a>-like
macro for defining app routes</li>
  <li><a href="https://github.com/lfex/exemplar">exemplar</a> - an LFE library for HTML as
LFE-native s-expressions</li>
</ul>

<p>Here are some highlights from the sample app:</p>

<h3 id="routes">Routes</h3>

<div class="highlight"><pre><code class="language-cl"><span class="p">(</span><span class="nv">defroutes</span>
  <span class="p">(</span><span class="ss">&#39;GET</span> <span class="s">&quot;/&quot;</span>
    <span class="p">(</span><span class="nv">sample-app-content:get-sidebar-content</span> <span class="nv">arg-data</span><span class="p">))</span>
  <span class="p">(</span><span class="ss">&#39;GET</span> <span class="s">&quot;/content/:id&quot;</span>
    <span class="p">(</span><span class="nv">sample-app-content:get-content</span> <span class="nv">id</span> <span class="nv">arg-data</span><span class="p">))</span>
  <span class="p">(</span><span class="ss">&#39;GET</span> <span class="s">&quot;/relation/:userid/:accountid&quot;</span>
    <span class="p">(</span><span class="nv">sample-app-content:get-content</span> <span class="nv">userid</span> <span class="nv">accountid</span> <span class="nv">arg-data</span><span class="p">))</span>
  <span class="c1">;; When nothing matches, do this</span>
  <span class="p">(</span><span class="ss">&#39;NOTFOUND</span>
   <span class="p">(</span><span class="k">let*</span> <span class="p">((</span><span class="nv">joined-path</span> <span class="p">(</span><span class="nv">++</span> <span class="s">&quot;/&quot;</span> <span class="p">(</span><span class="nv">string:join</span> <span class="nv">path</span> <span class="s">&quot;/&quot;</span><span class="p">)))</span>
          <span class="p">(</span><span class="nv">msg</span> <span class="p">(</span><span class="nv">++</span> <span class="s">&quot;Unmatched route!~n~n&quot;</span>
                   <span class="s">&quot;Path-info: ~p~n&quot;</span>
                   <span class="s">&quot;joined path: ~p~n&quot;</span>
                   <span class="s">&quot;arg-data: ~p~n~n&quot;</span><span class="p">))</span>
          <span class="p">(</span><span class="nv">msg-args</span> <span class="o">`</span><span class="p">(</span><span class="o">,</span><span class="nv">path</span> <span class="o">,</span><span class="nv">joined-path</span> <span class="o">,</span><span class="nv">arg-data</span><span class="p">)))</span>
    <span class="p">(</span><span class="nv">io:format</span> <span class="nv">msg</span> <span class="nv">msg-args</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">sample-app-content:four-oh-four</span>
      <span class="p">(</span><span class="nv">++</span> <span class="p">(</span><span class="nv">strong</span> <span class="s">&quot;Unmatched Route: &quot;</span><span class="p">)</span> <span class="nv">joined-path</span><span class="p">)))))</span></code></pre></div>

<h3 id="exemplar-content">Exemplar Content</h3>

<div class="highlight"><pre><code class="language-cl"><span class="p">(</span><span class="nb">defun</span> <span class="nv">get-side-menu</span> <span class="p">()</span>
  <span class="s">&quot;An example reusable menu.&quot;</span>
  <span class="p">(</span><span class="nb">list</span>
    <span class="p">(</span><span class="nv">li</span> <span class="p">(</span><span class="nv">a</span> <span class="o">&#39;</span><span class="p">(</span><span class="nv">href</span> <span class="s">&quot;/&quot;</span><span class="p">)</span> <span class="s">&quot;Main Page&quot;</span><span class="p">))</span>
    <span class="p">(</span><span class="nv">li</span> <span class="p">(</span><span class="nv">a</span> <span class="o">&#39;</span><span class="p">(</span><span class="nv">href</span> <span class="s">&quot;/content/1&quot;</span><span class="p">)</span> <span class="s">&quot;/content/1&quot;</span><span class="p">))</span>
    <span class="p">(</span><span class="nv">li</span> <span class="p">(</span><span class="nv">a</span> <span class="o">&#39;</span><span class="p">(</span><span class="nv">href</span> <span class="s">&quot;/content/2&quot;</span><span class="p">)</span> <span class="s">&quot;/content/2&quot;</span><span class="p">))</span>
    <span class="p">(</span><span class="nv">li</span> <span class="p">(</span><span class="nv">a</span> <span class="o">&#39;</span><span class="p">(</span><span class="nv">href</span> <span class="s">&quot;/content/3&quot;</span><span class="p">)</span> <span class="s">&quot;/content/3&quot;</span><span class="p">))</span>
    <span class="p">(</span><span class="nv">li</span> <span class="p">(</span><span class="nv">a</span> <span class="o">&#39;</span><span class="p">(</span><span class="nv">href</span> <span class="s">&quot;/relation/1/2&quot;</span><span class="p">)</span> <span class="s">&quot;/relation/1/2&quot;</span><span class="p">))</span>
    <span class="p">(</span><span class="nv">li</span> <span class="p">(</span><span class="nv">a</span> <span class="o">&#39;</span><span class="p">(</span><span class="nv">href</span> <span class="s">&quot;/bob&quot;</span><span class="p">)</span> <span class="s">&quot;404&quot;</span><span class="p">))))</span></code></pre></div>

<h2 id="closing">Closing</h2>

<p>There are soooo many more examples and use cases to explore. Hopefully we'll
be putting some of those up on this blog for the benefit and interest of our
kind readers.</p>

<p>If you have any questions about the material here, be sure to stop by the
<a href="https://groups.google.com/forum/#!forum/lisp-flavoured-erlang">LFE mail list</a>
and let us know.</p>

<p>Also, you have any any success stories, cool new LFE Docker images, or other
amazing tales to share, we want to hear those :-)</p>

<p>See you there!</p>

          <hr>
          <div class="pagination btn-group">
            
            <a class="btn prev" href="/news/2019/05/13/0250-catch-up" title="Catch Up">&larr; Previous</a>
            
            <a class="btn" href="/archive.html">Archive</a>
            
            <a class="btn next disabled">Next &rarr;</a>
            
          </div>
          <hr>
          
        </div>

        <div class="span4">
          <section>
            <h4>Author</h4>
            <div class="author"><span><a href="/authors.html#Duncan McGreggor">Duncan McGreggor</a></span></div>
          </section>
          <section>
            <h4>Published</h4>
            <div class="date"><span>13 May 2019</span></div>
          </section>
          
          <section>
            <h4>Category</h4>
            <span class="category">
              tutorials
            </span>
          </section>
          
          
          <section>
            <h4>Tags</h4>
            <ul class="tag_box">
              
              


  
     
    	<li><a href="/tags.html#docker-ref">docker <span>4</span></a></li>
     
    	<li><a href="/tags.html#paas-ref">paas <span>3</span></a></li>
     
    	<li><a href="/tags.html#howtos-ref">howtos <span>9</span></a></li>
     
    	<li><a href="/tags.html#web-ref">web <span>8</span></a></li>
     
    	<li><a href="/tags.html#apps-ref">apps <span>3</span></a></li>
     
    	<li><a href="/tags.html#ops-ref">ops <span>3</span></a></li>
     
    	<li><a href="/tags.html#lfest-ref">lfest <span>3</span></a></li>
     
    	<li><a href="/tags.html#exemplar-ref">exemplar <span>3</span></a></li>
    
  



            </ul>
          </section>
          
        </div>
      </div>


    </div>
  </div> <!-- /container -->
</div>




    <div id="footer" >
    <div class="lower_footer">
      <ul class="footer-cell">
        <li><a href="/archive.html">Archives</a></li>
        <li><a href="/categories.html">Categories</a></li>
        <li><a href="/tags.html">Tags</a></li>
        <li><a href="/authors.html">Authors</a></li>
        <li><a href="/pages.html">Pages</a></li>
      </ul>

      <span class="footer-cell">
        <a href="/"><img src="/assets/themes/lfe/images/logo-white.png"/></a>
      </span>

      <ul class="footer-cell">
        <li><a href="http://github.com/lfex">lfex</a></li>
        <li><a href="https://groups.google.com/forum/#!forum/lisp-flavoured-erlang">List</a></li>
        <li><a href="http://webchat.freenode.net/?channels=erlang-lisp">IRC</a></li>
        <li><a href="http://feeds.feedburner.com/lfe/news-and-updates">RSS</a></li>
        <li><a href="http://twitter.com/ErlangLisp">Twitter</a></li>
        <li><a href="http://github.com/rvirding/lfe">Github</a></li>
      </ul>
    </div>

    <div class="wrapper">
      <p>Original Design &copy; <span class="js-year"></span> GitHub, Inc.</p>
      <p>LFE Design and Content &copy; <span class="js-year"></span> LFEuminati | Alien Alliance</p>
    </div>

  </div><!-- /#footer -->

    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
    <script>window.jQuery || document.write('<script src="/assets/themes/lfe/js/jquery.min.js"><\/script>')</script>
    <script src="/assets/themes/lfe/bootstrap/js/bootstrap.min.js"></script>

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-38274766-2', 'auto');
      ga('send', 'pageview');

    </script>
  </body>
</html>

